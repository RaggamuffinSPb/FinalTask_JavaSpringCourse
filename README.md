### API Интернет-магазина автозапчастей 
Backend-часть для интернет-магазина.  
Реализовано на Java + Spring (boot, jpa, jwt, web, security) + PostgreSQL.  
Позволяет управлять товарами, категориями и остатками на складе.

## Авторизация и доступ
### 1. Регистрация нового пользователя
Метод: POST  
URL: /api/auth/register  
Заголовки: Content-Type: application/json  
Тело запроса (JSON):  

```json
{
"username": "vasya",
"password": "123456"
}
```

Ответ: 200 OK с сообщением об успешной регистрации.

### 2. Вход (получение JWT токена)
Метод: POST
URL: /api/auth/login
Заголовки: Content-Type: application/json
Тело запроса (JSON):


```json
{
"username": "admin",
"password": "admin"
}
```
Ответ: 200 OK с токеном:

```json
{
"token": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
}
```  

Использование токена: Вставляйте полученный токен в заголовок Authorization: Bearer <ваш_токен> для всех защищённых запросов ниже.

## Управление категориями
### 3. Создание категории (требует JWT)
Метод: POST
URL: /api/categories
Заголовки: Authorization: Bearer <ваш_токен>
Тело запроса (JSON):  
```json
{
"categoryName": "Автомузыка",
"description": "Магнитолы, сабвуферы"
}
```
Ответ при успехе: 201 Created с данными категории.
Ошибка: Если категория с таким именем уже есть — 409 Conflict с сообщением.

### 4. Получение списка всех категорий (публичный)
Метод: GET  
URL: /api/categories  
Ответ: 200 OK с массивом категорий.  

## Управление товарами
### 5. Создание товара (требует JWT)
Метод: POST

URL: /api/items  
Заголовки: Authorization: Bearer <ваш_токен>  
```json
{
"itemName": "Магнитола Pioneer DEH-80PRS",
"itemDescription": "Флагманская магнитола с процессором",
"price": 45000.00,
"quantityInStock": 5,
"categoryId": 1
}
```

Ответ при успехе: 201 Created с данными товара.

### 6. Получение всех товаров (публичный)
Метод: GET

URL: /api/items  
Ответ: 200 OK с массивом товаров, отсортированных по категории и ID.

### 7. Получение товаров по категории (публичный)
Метод: GET

URL: /api/items/by-category/2 (где 2 — ID категории)  
Ответ: 200 OK с массивом товаров указанной категории.

## Управление остатками (отгрузка/поступление)
### 8. Изменение количества товара (требует JWT + api-key) 
Метод: POST

URL: /api/items/update-stock  
Обязательные заголовки:  
Authorization: Bearer <ваш_JWT_токен>  
X-API-Key: student_secret_key_123 (ключ админа, выданный при инициализации)
Тело запроса (JSON):
```json
{
"itemId": 3,
"quantity": -2
}
```

Примечание:

quantity положительный — товар прибыл на склад.  
quantity отрицательный — товар отгружен со склада.  
Ответ при успехе: 200 OK с обновлёнными данными товара.  

Возможные ошибки:  
Если не передан X-API-Key → 401 Unauthorized.  
Если X-API-Key неверный → 403 Forbidden.  
Если товара недостаточно для отгрузки → 400 Bad Request.  

## Настройка и запуск
База данных: PostgreSQL. Создайте базу с именем apistoredb.  
Настройки подключения: Укажите правильные url, username и password в файле application.yml.  
Запуск: Запустите главный класс приложения ApistoreApplication.  
Первоначальные данные: При первом запуске автоматически выполнятся скрипты из data.sql:  
Создастся пользователь admin (пароль: admin, api-key: student_secret_key_123).  
Добавятся 5 категорий и 10 тестовых товаров.

### Примечания
Роли: В системе есть роль ADMIN (у неё есть api-key) и USER (обычный пользователь).  
Валидация: Проверяются обязательные поля и уникальность названий категорий.  
Обработка ошибок: Все ошибки возвращаются в формате {"code": "...", "message": "..."}.
